---
title: "Tutorial on yajing625pkg"
author: "Yajingli"
date: "11/10/2019"
output: html_document
vignette: >
  %\VignetteIndexEntry{Tutorial on yajing625pkg}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r}
set.seed(101)
n=200
mood=data.frame(age=sample(seq(18,25),n,replace=T),
                sex=sample(c("Female","Male"),n,replace=T),
                gpa=sample(seq(2,4,0.1),n,replace=T),
                exercise=sample(c("Everyday","Often","Seldom"),n,replace=T),
                local=sample(c("TRUE","FALSE"),n,replace=T),
                mood=sample(c("bad","ok","excellent"),n,replace=T))

x=mood[1:150,1:5]
y=mood[1:150,6]
newdata=mood[151:n,1:5]
```

```{r}
test.na=mood
test.na$age[sample.int(100,10,replace = F)]=NA
test.na$sex[sample.int(100,10,replace = F)]=NA
test.na$gpa[sample.int(100,10,replace = F)]=NA
test.na$exercise[sample.int(100,10,replace = F)]=NA
test.na$local[sample.int(100,10,replace = F)]=NA
x=test.na[1:80,1:5]
y=test.na[1:80,6]
newdata=test.na[81:100,1:5]
```

```{r}
#devtools::install_github("LiArAu/NaBa")
library(NaBa)
library(Rcpp)
prior=NaBa::Info_prior(x,y)
myresult_raw=predict_naBa(prior,newdata,"raw")
myresult_class=NaBa::predict_naBa(prior,newdata,"class")
library(e1071)
prior2=e1071::naiveBayes(x,y)
e1071result_raw=predict(prior2,newdata,"raw")
e1071result_class=predict(prior2,newdata)
library(naivebayes)
prior3=naivebayes::naive_bayes(x,y)
nbresult_raw=predict(prior3,newdata,"prob")
nbresult_class=predict(prior3,newdata)
```

```{r}
#Comparisons
all.equal(myresult_raw,e1071result_raw)
all.equal(myresult_class,e1071result_class)


library(microbenchmark)
library(ggplot2)

tm <- microbenchmark::microbenchmark(
NaBa_result=predict_naBa(prior,newdata,"raw"),
e1071_result=predict(prior2,newdata,"raw"),
naivebayes_result=predict(prior3,newdata,"prob"))
ggplot2::autoplot(tm)
```

